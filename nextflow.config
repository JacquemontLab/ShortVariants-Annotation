manifest {
    name        = 'ShortVariants-Annotation'
    author      = 'Florian Bénitière'
    description = 'A Nextflow pipeline for annotating Short Variants (SNVs and Indels) on large dataset.'
    version     = '4.0.0'
}


env {
    PATH = "\$PATH:${projectDir}/bin/dataset_specific"
}


profiles {
    
    // Test profile
    test {
         params {
            file_gvcf_path = "${projectDir}/tests/sample_to_gvcf.tsv.gz"
            fasta_ref = "${projectDir}/resources/reference_genome/GRCh38_full_analysis_set_plus_decoy_hla.fa.gz"
            vep_cache = "${projectDir}/resources/vep_cache/"
            batch_size = 3
        } 
    }

    // Apptainer containers
    apptainer {
        apptainer.enabled = true
        apptainer.autoMounts = true

        process  {
            withLabel: genomics_tools {
                container = 'docker://ghcr.io/jacquemontlab/genomics_tools:latest'
            }

            withLabel: pyspark {
                container = 'docker://ghcr.io/jacquemontlab/pyspark:latest'
            }

            withLabel: duckdb_python {
                container = 'docker://ghcr.io/jacquemontlab/duckdb_python:latest'
            }

            withLabel: ensembl_vep_113 {
                container = 'docker://ghcr.io/jacquemontlab/ensembl_vep_113.3:latest'
            }
        }
    }

    // Singularity containers
    singularity {
        singularity.enabled = true
        singularity.autoMounts = true

        process  {
            withLabel: genomics_tools {
                container = 'docker://ghcr.io/jacquemontlab/genomics_tools:latest'
            }

            withLabel: pyspark {
                container = 'docker://ghcr.io/jacquemontlab/pyspark:latest'
            }

            withLabel: duckdb_python {
                container = 'docker://ghcr.io/jacquemontlab/duckdb_python:latest'
            }

            withLabel: ensembl_vep_113 {
                container = 'docker://ghcr.io/jacquemontlab/ensembl_vep_113.3:latest'
            }
        }
    }

    // Docker containers
    docker {
        docker.enabled = true
        docker.autoMounts = true

        process  {
            withLabel: genomics_tools {
                container = 'ghcr.io/jacquemontlab/genomics_tools:latest'
            }

            withLabel: pyspark {
                container = 'ghcr.io/jacquemontlab/pyspark:latest'
            }

            withLabel: duckdb_python {
                container = 'ghcr.io/jacquemontlab/duckdb_python:latest'
            }

            withLabel: ensembl_vep_113 {
                container = 'ghcr.io/jacquemontlab/ensembl_vep_113.3:latest'
            }
        }
    }
}